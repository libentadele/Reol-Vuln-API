# exploit_script

This folder contains a small PoC script that demonstrates a NoSQL injection against the example vulnerable server in this repository.

Purpose
- Quick proof-of-concept for security testing and education.

Usage
- Inspect the script before running it.
- Run with Python 3 from this directory:

# exploit_script

This folder contains a small PoC script that demonstrates NoSQL injection techniques against the example vulnerable server in this repository.

Purpose
- Quick proof-of-concept for security testing and education.

How it works
- Overview: the script runs a short, ordered set of checks and actions that show how NoSQL inputs can be abused when a server passes untrusted JSON into a database query.
- Three stages:
	1. Discovery — probes endpoints to find injection points (operator and regex injections).
		 - sends crafted JSON payloads (for example: {"password": {"$ne": null}} or {"username": {"$regex": ".*"}}) to /auth/login and looks for authentication bypasses or wide matches.
		 - queries the public search endpoint with a JSON query string to see if results can be broadened (e.g. q={"$regex":".*"}).
	2. Authentication bypass — attempts to obtain a valid token by exploiting weak server-side handling of query objects (operator injection). If a token is returned the script uses it to try protected admin endpoints.
		 - example: POST /auth/login with {"username":"admin","password":{"$ne":null}} then use returned token in Authorization header to call /admin/export.
	3. Data extraction — uses found injection points and, if available, admin access to enumerate and extract sensitive records.
		 - examples: broad /search queries, POST /users/filter for fields like SSN, POST /records/search for medical records, and POST /admin/query or /admin/export for admin-only data.

What tests it performs
- Authentication bypass tests:
	- Operator injection: posts a payload with $ne (not-equals) to bypass password checks.
	- Regex injection: posts payloads using $regex to match many usernames.
- Search and enumeration tests:
	- GET /search?q=<json> where the json is a query (often a $regex) to enumerate users.
	- POST /users/filter with a filter like {"ssn":{"$exists":true}} to find records containing SSNs.
- Admin/privileged checks (only attempted if a token is obtained):
	- POST /admin/query with a JSON query to test whether admin query endpoints accept raw query strings.
	- POST /admin/export to see whether a full export of users/records is possible with the token.

Usage
- Inspect the script before running it.
- Run with Python 3 from this directory:

```bash
python3 nosql_exploit.py
```

Notes
- Only run against local test instances or systems you own/have permission to test.
- The script is intentionally minimal and meant for learning; it may need adjustments depending on the target server's configuration (port, endpoints, or JSON shape).

Safety / License
- No warranty. Use responsibly. Do not use this script on targets without explicit authorization.
